<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SMARTTR">
<title>SMARTTR • SMARTTR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SMARTTR">
<meta property="og:description" content="SMARTTR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SMARTTR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/SMARTTR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Part1.Segmentation.html">1. Imaging, segmentation, and preprocessing</a>
    <a class="dropdown-item" href="../articles/Part2.Tutorial.html">2. Mapping Tutorial</a>
    <a class="dropdown-item" href="../articles/Part3.Scripting.html">3. Scripting &amp; notebooks</a>
    <a class="dropdown-item" href="../articles/Part4.Example_Analysis_Notebook.html">4. Example analysis notebook</a>
    <a class="dropdown-item" href="../articles/Part5.ImportingExternalDatasets.html">5. Importing External Datasets</a>
    <a class="dropdown-item" href="../articles/Part6.FAQ.html">6. FAQ</a>
    <a class="dropdown-item" href="../articles/Part7.Development.html">7. Development environment</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mjin1812/SMARTTR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SMARTTR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mjin1812/SMARTTR/blob/HEAD/vignettes/SMARTTR.Rmd" class="external-link"><code>vignettes/SMARTTR.Rmd</code></a></small>
      <div class="d-none name"><code>SMARTTR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="prior-steps-to-get-started">0 Prior steps to get started<a class="anchor" aria-label="anchor" href="#prior-steps-to-get-started"></a>
</h2>
<p><code>SMARTTR</code> stands for <strong>s</strong>imple
<strong>m</strong>ulti-ensemble <strong>a</strong>tlas
<strong>r</strong>egistration and s<strong>t</strong>atistical
<strong>t</strong>esting in <strong>R</strong>. It is also a
self-referential play on a previous package developed as an extension to
<code>wholebrain</code> called <code>SMART</code>.<code>SMARTTR</code>
interfaces with some functions from both of these packages underneath
the hood.</p>
<p><code>SMARTTR</code> encapsulates the process of registration and
performs downstream analysis. Prior to this, the imaging data must be
pre-processed and cells are separately segmented in ImageJ/FIJI. We have
a separate, in-depth article on our imaging and pre-processing approach,
parameters, and segmentation process. We provide links to an example
image to run though the pre-processing and segmentation. There is also a
separate in-depth tutorial article for SMARTTR using this example image.
This page provides installation instructions and a broad explanation of
the central package organization around data objects</p>
<figure><img src="../reference/figures/3.acquisition_segmentation_preprocess_schematic.jpg" alt="Image" style="width: 650px; height: 400px;"><figcaption><em>Imaging, segmentation, and pre-processing pipeline</em>
</figcaption></figure>
</div>
<div class="section level2">
<h2 id="installation-for-windows">1 Installation for Windows<a class="anchor" aria-label="anchor" href="#installation-for-windows"></a>
</h2>
<div class="section level3">
<h3 id="install-rstudio-r">1.1 Install RStudio R<a class="anchor" aria-label="anchor" href="#install-rstudio-r"></a>
</h3>
<p>We recommend installing R version 3.6 for compatibility with
<code>wholebrain</code> for registration and mapping. You can download
it <a href="https://cran-archive.r-project.org/bin/windows/base/old/3.6.3/" class="external-link">here</a>
for Windows.</p>
<p>However, we will soon be releasing and supporting a separate version
of SMARTTR supporting R versions 4.1+ for users who only need access to
analysis and visualization capabilities. Importation from other
workflows would be supported on this version.</p>
</div>
<div class="section level3">
<h3 id="install-wholebrain">1.2 Install <code>wholebrain</code><a class="anchor" aria-label="anchor" href="#install-wholebrain"></a>
</h3>
<p>Installing <code>wholebrain</code> can be finicky. The most updated
instructions on installing <code>wholebrain</code> for Windows is found
<a href="https://matiasandina.github.io/wholebrain_install/" class="external-link">here</a>.
For Macs, the instructions can be found <a href="https://osf.io/k963s" class="external-link">here</a>. We strongly recommend using a
Windows setup, as this package has been used mostly in Windows.</p>
<p>If wholebrain is not installed, only the analysis and visualization
functions may work.</p>
</div>
<div class="section level3">
<h3 id="install-rtools">1.3 Install Rtools<a class="anchor" aria-label="anchor" href="#install-rtools"></a>
</h3>
<p>If you are using R 3.6+ on a Windows machine, you will need to
install Rtools version 3.5. Download it <a href="https://cran.r-project.org/bin/windows/Rtools/Rtools35.exe" class="external-link">here</a>
if you haven’t already installed it during the <code>wholebrain</code>
installation process.</p>
</div>
<div class="section level3">
<h3 id="install-smarttr">1.4 Install <code>SMARTTR</code><a class="anchor" aria-label="anchor" href="#install-smarttr"></a>
</h3>
<p>To to download the package from github, we need to use the
<code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github()</a></code> function from the <code>remotes</code>
package. There are also a number of packages imports. Install the
package with the code below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install remotes package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span>, contriburl <span class="op">=</span> <span class="st">"https://cran-archive.r-project.org/bin/windows/contrib/3.6/"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sometimes, the dependencies are not installed with the appropriate up-to-date version. Below, we install dplyr from source and specify the exact version for compatibility.</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_version.html" class="external-link">install_version</a></span><span class="op">(</span><span class="st">"dplyr"</span>, version <span class="op">=</span> <span class="st">"1.1.0"</span>, INSTALL_opts <span class="op">=</span> <span class="st">"--no-multiarch"</span><span class="op">)</span>;</span>
<span></span>
<span><span class="co"># Install package dependencies. This may result in an error in the final step for installing SMARTTR</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mjin1812/SMARTTR@main"</span>, contriburl <span class="op">=</span> <span class="st">"https://cran-archive.r-project.org/bin/windows/contrib/3.6/"</span>, </span>
<span>                        dependencies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Depends"</span>, <span class="st">"Imports"</span><span class="op">)</span>, INSTALL_opts <span class="op">=</span> <span class="st">"--no-multiarch"</span><span class="op">)</span></span></code></pre></div>
<p>You may run into something similar to the following error messages
below:</p>
<pre><code>Warning message:
package ‘C:/Users/[User]/AppData/Local/Temp/RtmpGo67wj/file261419dd3f94/SMARTTR_1.0.1.tar.gz’ is not available (for R version 3.6.3)</code></pre>
<p>If this is the case try the following steps:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install Hmisc. This is a package dependency but is sometimes skipped. Enter a space to skip any updates.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"Hmisc"</span>, contriburl <span class="op">=</span> <span class="st">"https://cran-archive.r-project.org/bin/windows/contrib/3.6/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try the following command again without the contriburl parameter to install SMARTTR. Enter a space to skip any updates.</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mjin1812/SMARTTR@main"</span>, dependencies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Depends"</span>, <span class="st">"Imports"</span><span class="op">)</span>, INSTALL_opts <span class="op">=</span> <span class="st">"--no-multiarch"</span><span class="op">)</span></span></code></pre></div>
<p>We can now load the package!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load SMARTTR</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjin1812.github.io/SMARTTR/">SMARTTR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># You can pull up the package description with the code below:</span></span>
<span><span class="op">?</span><span class="va">SMARTTR</span></span></code></pre></div>
<blockquote>
<p>Tip: From now on, get in the habit of using the <code>?</code>
operator to pull up the help page about a package, object, function, or
piece of data</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="troubleshooting-dependencies">1.5 Troubleshooting dependencies<a class="anchor" aria-label="anchor" href="#troubleshooting-dependencies"></a>
</h3>
<p>If you are running into package dependency or version issues, you can
edit run the following code below to install the relevant packages
manually. Then rerun the <code><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">remotes::install_github()</a></code> command
from the section above.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># You can edit the following list of packages to install any ones which may missing. Enter a space to skip any updates.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hmisc"</span>, <span class="st">"gtable"</span>,<span class="st">"dplyr"</span>, <span class="st">"readr"</span>, <span class="st">"readxl"</span>, <span class="st">"tidyselect"</span>, <span class="st">"tidyr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"igraph"</span>, <span class="st">"tidygraph"</span>, <span class="st">"ggraph"</span>, <span class="st">"stringdist"</span>, <span class="st">"stringr"</span>, <span class="st">"grImport"</span><span class="op">)</span>, contriburl <span class="op">=</span> <span class="st">"https://cran-archive.r-project.org/bin/windows/contrib/3.6/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Try uncommenting and using the commands below to install and compile certain individual packages from source if the above commands show problems.</span></span>
<span><span class="co"># cp11_url &lt;- "https://cran.r-project.org/src/contrib/Archive/cpp11/cpp11_0.5.0.tar.gz";install.packages(cp11_url, repos=NULL, type="source")</span></span>
<span><span class="co"># install_version("tidyr", version = "1.1.3", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("dplyr", version = "1.1.0", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("readr", version = "2.0.1", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("readxl", version = "1.3.1", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("gtable", version = "0.3.5", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("ggplot2", version = "3.3.5", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("tidyselect", version = "1.1.1", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("igraph", version = "1.2.6", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("tidygraph", version = "1.2.0", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("ggraph", version = "2.1.0", INSTALL_opts = "--no-multiarch");</span></span>
<span><span class="co"># install_version("stringdist", version = "0.9.7", INSTALL_opts = "--no-multiarch")</span></span>
<span><span class="co"># install_version("Hmisc", version = "4.5.0", INSTALL_opts = "--no-multiarch");</span></span>
<span></span>
<span><span class="co">## Optional: uncomment below to install ggpattern package (can be useful package for certain plotting options) </span></span>
<span><span class="co"># remotes::install_github("coolbutuseless/ggpattern")</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="installation-for-mac">2 Installation for Mac<a class="anchor" aria-label="anchor" href="#installation-for-mac"></a>
</h2>
<p>Instructions will be available soon!</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="introduction-to-smarttr">3 Introduction to SMARTTR<a class="anchor" aria-label="anchor" href="#introduction-to-smarttr"></a>
</h2>
<div class="section level3">
<h3 id="oop-in-r">3.1 OOP in R<a class="anchor" aria-label="anchor" href="#oop-in-r"></a>
</h3>
<p>It’s helpful to get a sense of a how the structure of data is handled
and bundled together in this pipeline. Data is stored in S3 data type
objects called <code>slice</code>, <code>mouse</code>, and
<code>experiment</code>. The data in these objects will be manipulated
by a special type of function called a generic function (this is
analogous to an object method in python). Generic functions allow you to
pass objects of different classes to the same function, and it can
recognize and perform different operations on objects depending on their
class. If this is all confusing to you, don’t worry at all! This is much
more information than you actually need to know to use this pipeline.
It’s just helpful to better understand the architecture of the
package.</p>
<p>To get an excellent brief overview of what object oriented
programming (OOP) is and it’s advantages over procedural programming,
check out this excellent <a href="https://www.youtube.com/watch?v=pTB0EiLXUC8&amp;t=379s&amp;ab_channel=ProgrammingwithMosh" class="external-link">YouTube
video!</a></p>
</div>
<div class="section level3">
<h3 id="slice-objects">3.2 Slice objects<a class="anchor" aria-label="anchor" href="#slice-objects"></a>
</h3>
<p>A <code>slice</code> object will contain all the data related to
registration, segmentation for each channel, and cell counts for a
particular image.</p>
<p>It will also contain metadata about your images, such as what the
<code>slice no.</code> is, which brain atlas AP coordinate matches best
with the given image, and what the path to the image used for
registration is. These metadata are stored as the object’s
attributes.</p>
<p>Run the code below to used the <code>?</code> operator to pull up the
documentation for a <code>slice</code> object. This will pull up a help
page description of all the <code>slice</code> object attributes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu">SMARTTR</span><span class="fu">::</span><span class="va"><a href="../reference/slice.html">slice</a></span></span></code></pre></div>
<blockquote>
<p>Tip: Usage of the <code>::</code> or double colons here means that R
specifically looks for a function, object, or help page in
<code>SMARTTR</code> package. This isn’t necessary if you load the
package, but it can sometimes help avoid ambiguity if there are
identical names for things in other loaded packages.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="mouse-objects">3.3 Mouse objects<a class="anchor" aria-label="anchor" href="#mouse-objects"></a>
</h3>
<p>A <code>mouse</code> object is an object that will store multiple
<code>slice</code> objects (and therefore all the information in it),
and will eventually store the combined cell data and the region cell
counts normalized by volume. Like a <code>slice</code>, it will also
contain “metadata” about your mouse stored as string attributes. Now,
try pulling up the help page yourself for the <code>mouse</code> object
to see all attributes you can store!</p>
</div>
<div class="section level3">
<h3 id="experiment-object">3.4 Experiment object<a class="anchor" aria-label="anchor" href="#experiment-object"></a>
</h3>
<p>An experiment object will primarily store the processed information
from multiple <code>mouse</code> objects. Some experimental attributes
will autopopulate based on mouse attributes. For example, if multiple
mice are added to an experiment with the <code>drug</code> attribute
values <code>ketamine</code> or <code>saline</code>, the experiment
attribute <code>drug_groups</code> will be a vector with the values
<code>ketamine</code> and <code>saline</code>.</p>
<figure><img src="../reference/figures/object_schematic.jpg" alt="Image" style="width: 600px;"><figcaption><em>Hierarchical object organization in the package</em>
</figcaption></figure>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michelle Jin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
